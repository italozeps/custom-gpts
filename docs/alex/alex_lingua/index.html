<!DOCTYPE html>
<html lang="lv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Alex — lingua.id.lv</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-slate-50 text-slate-900">
  <header class="max-w-5xl mx-auto px-4 pt-10 pb-6">
    <h1 class="text-3xl sm:text-4xl md:text-5xl font-black tracking-tight">Alex — lingua.id.lv</h1>
    <p class="mt-3 text-lg sm:text-xl text-slate-600">
      Converse in your natural language; Perplexity will respond in your chosen language.
    </p>
    <p class="mt-1 text-sm text-amber-700">
      Piezīme: Te saraksts ievietotais var tikt mainīts. Lūdzu, ierosiniet, kas ievietojams, vai precizējams konfigurējot
    </p>
  </header>

  <main class="max-w-5xl mx-auto px-4 pb-16">
    <!-- Input area -->
    <section class="mb-6">
      <label for="userQuestion" class="block text-sm font-medium text-slate-700 mb-1">Jūsu jautājums / tēma</label>
      <textarea id="userQuestion" class="w-full rounded-xl border border-slate-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:border-slate-400" rows="3" placeholder="Rakstiet šeit brīvā valodā; atbilde būs izvēlētajā valodā."></textarea>
      <div class="mt-2 flex items-center gap-3 text-sm text-slate-600">
        <label class="inline-flex items-center gap-2">
          <input id="openSameTab" type="checkbox" class="rounded border-slate-300" />
          Atvērt tajā pašā cilnē
        </label>
        <button id="clearBtn" class="ml-auto px-3 py-1.5 rounded-lg border border-slate-300 hover:bg-slate-100">Notīrīt jautājumu</button>
      </div>
    </section>

    <!-- Cards grid -->
    <section>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
        <!-- Cards rendered by JS -->
      </div>
    </section>
  </main>

  <footer class="max-w-5xl mx-auto px-4 pb-10 text-xs text-slate-500">
    <p>Šī lapa ģenerē Perplexity meklēšanas saiti ar iepriekšpievienotu instrukciju piespiest atbildēt izvēlētajā valodā. Jautājums paliek tieši tāds, kā ievadīts augstāk.</p>
  </footer>

  <script id="languages-csv" type="text/csv">id,title,subtitle,instruction
la,Latīņu,classica / neo-classica,"Tu es CGPT, id est Classicus GPT. Responde semper LATINE TANTUM, sermone puro, classico vel neo-classico, eleganter phrasibus constructo, sine ullo verbo barbaro, nisi ipsae res recentiores sine vitio dici nequeunt. Omnes responsiones tuas in eadem lingua perfice, quaesitum quamcumque linguam habeat."
grc,Sengrieķu,Ἀττικὴ / κλασική,"Answer strictly in Ancient (Classical/Attic) Greek. Use classical morphology and syntax; avoid modern Greek vocabulary and spelling. Keep all replies entirely in Ancient Greek regardless of the question language."
hbo,Senebreju,Biblical Hebrew,"Answer strictly in Biblical (Classical) Hebrew. Use consonantal vocabulary with standard niqqud where relevant; avoid modern Hebrew forms. Keep all replies entirely in Biblical Hebrew."
syc,Klasiskā sīriešu,Classical Syriac,"Answer strictly in Classical Syriac. Use classical orthography and vocabulary; avoid modern dialect forms. Keep all replies entirely in Classical Syriac."
cu-bg,Bulgāru (senā),Old Bulgarian,"Answer strictly in Old Bulgarian (Early Church Slavonic). Use historical/Church Slavonic norms; avoid modern Bulgarian. Keep all replies entirely in Old Bulgarian."
cu,Senslāvu,Old Church Slavonic,"Answer strictly in Old Church Slavonic. Use Church Slavonic orthography and lexicon; avoid modern Slavic forms. Keep all replies entirely in Old Church Slavonic."
uk,Ukraiņu,сучасна літературна,"Відповідай лише українською літературною мовою. Зберігай стиль охайний і чіткий; не перемикайся на інші мови, незалежно від мови запитання."
cs,Čehu,spisovná čeština,"Odpovídej výhradně spisovnou češtinou. Zachovej konzistentně češtinu bez přepínání do jiných jazyků, bez ohledu na jazyk dotazu."
de,Vācu,Hochdeutsch,"Antworte ausschließlich auf Hochdeutsch in klarer, eleganter Prosa, unabhängig von der Sprache der Frage."
en,Angļu,formal / neutral,"Answer strictly in English. Maintain a clear, formal or neutral style regardless of the question language."
es,Spāņu,español estándar,"Responde estrictamente en español estándar, con estilo claro y correcto, sin cambiar de idioma aunque la pregunta esté en otra lengua."
fr,Franču,français standard,"Réponds strictement en français standard, style clair et soutenu; ne change jamais de langue, quelle que soit la langue de la question."
it,Itāļu,italiano standard,"Rispondi esclusivamente in italiano standard, con stile chiaro ed elegante, indipendentemente dalla lingua della domanda."
</script>

<script>
  const CSV_URL = 'languages.csv';
  const PPLX_BASE = 'https://www.perplexity.ai/search?q=';

  const grid = document.querySelector('.grid');
  const qEl = document.getElementById('userQuestion');
  const sameTabEl = document.getElementById('openSameTab');
  document.getElementById('clearBtn').addEventListener('click', () => { qEl.value = ''; qEl.focus(); });

  // Vienkāršs CSV parseris + BOM noņemšana
  function parseCSV(text) {
    // noņem BOM, ja tāds ir
    if (text.charCodeAt(0) === 0xFEFF) text = text.slice(1);

    const rows = [];
    let cur = '', row = [], quoted = false;
    for (let i = 0; i < text.length; i++) {
      const c = text[i], n = text[i+1];
      if (quoted) {
        if (c === '"' && n === '"') { cur += '"'; i++; }
        else if (c === '"') { quoted = false; }
        else { cur += c; }
      } else {
        if (c === '"') quoted = true;
        else if (c === ',') { row.push(cur); cur = ''; }
        else if (c === '\n' || c === '\r') {
          if (cur.length || row.length) { row.push(cur); rows.push(row); row = []; cur = ''; }
        } else { cur += c; }
      }
    }
    if (cur.length || row.length) { row.push(cur); rows.push(row); }

    const cleaned = rows.filter(r => r && r.join('').trim().length);
    if (!cleaned.length) return [];

    const header = cleaned[0].map(h => h.trim().replace(/^\uFEFF/, '')); // drošs BOM noņemšana
    const idx = Object.fromEntries(header.map((h, i) => [h, i]));

    const need = ['id','title','subtitle','instruction'];
    const ok = need.every(k => typeof idx[k] === 'number');
    if (!ok) {
      console.error('CSV headers mismatch. Got:', header);
      return [];
    }

    return cleaned.slice(1).map(r => ({
      id: (r[idx.id]||'').trim(),
      title: (r[idx.title]||'').trim(),
      subtitle: (r[idx.subtitle]||'').trim(),
      instruction: (r[idx.instruction]||'').trim(),
    })).filter(x => x.id && x.instruction);
  }

  function buildPerplexityURL(instruction, userQ) {
    const trimmed = (userQ || '').trim();
    const payload = instruction + (trimmed ? "\n\n" + trimmed : '');
    return PPLX_BASE + encodeURIComponent(payload);
  }

  function renderCards(cards) {
    grid.innerHTML = '';
    cards.forEach(cfg => {
      const card = document.createElement('div');
      card.className = 'rounded-2xl border border-slate-200 bg-white p-4 shadow-sm hover:shadow-md transition-shadow';
      card.innerHTML = `
        <div class="flex items-start justify-between gap-3">
          <div>
            <h3 class="text-lg font-bold">${cfg.title || cfg.id}</h3>
            <p class="text-sm text-slate-600">${cfg.subtitle || ''}</p>
          </div>
          <button data-id="${cfg.id}" class="startBtn inline-flex items-center gap-2 px-3 py-1.5 rounded-xl bg-slate-900 text-white text-sm hover:bg-slate-800 active:scale-[0.98]">Start</button>
        </div>`;
      grid.appendChild(card);
    });
  }

  document.addEventListener('click', (e) => {
    const btn = e.target.closest('.startBtn');
    if (!btn) return;
    const id = btn.getAttribute('data-id');
    const cfg = (window.__CARDS__ || []).find(c => c.id === id);
    if (!cfg) return;
    const url = buildPerplexityURL(cfg.instruction, qEl.value);
    sameTabEl.checked ? (window.location.href = url) : window.open(url, '_blank', 'noopener');
  });

  async function loadCards() {
    try {
      const resp = await fetch(CSV_URL, { cache: 'no-store' });
      if (!resp.ok) throw new Error('HTTP ' + resp.status);
      const txt = await resp.text();
      const cards = parseCSV(txt);
      if (cards.length) return cards;
      throw new Error('Parsed 0 cards from external CSV');
    } catch (e) {
      console.warn('Using inline CSV fallback:', e.message || e);
      const inline = document.getElementById('languages-csv');
      const txt = (inline && inline.textContent) ? inline.textContent : '';
      return parseCSV(txt);
    }
  }

  loadCards().then(cards => {
    window.__CARDS__ = cards;
    if (!cards.length) {
      grid.innerHTML = `
        <div class="text-sm text-red-700">
          Kartītes neizdevās ielādēt. Pārbaudi:
          <ul class="list-disc ml-5 mt-2">
            <li><code>languages.csv</code> ceļu (tam jābūt tajā pašā mapē)</li>
            <li>CSV galvenes: <code>id,title,subtitle,instruction</code></li>
            <li>BOM (saglabā kā UTF-8 bez BOM)</li>
          </ul>
          <div class="mt-2"><a class="underline" href="languages.csv" target="_blank">Atvērt languages.csv</a></div>
        </div>`;
      return;
    }
    renderCards(cards);
  }).catch(err => {
    console.error(err);
    grid.innerHTML = '<div class="text-sm text-red-700">Neizdevās ielādēt languages.csv</div>';
  });
</script>
  italozeps.github.io/custom-gpts/cgpt/
</body>
</html>
